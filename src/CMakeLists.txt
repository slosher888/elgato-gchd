FIND_PACKAGE(PkgConfig REQUIRED)
PKG_CHECK_MODULES(LIBUSB libusb-1.0 REQUIRED)

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR} ${LIBUSB_INCLUDE_DIRS})

AUX_SOURCE_DIRECTORY(${CMAKE_CURRENT_SOURCE_DIR} ROOT_SRC)
AUX_SOURCE_DIRECTORY("${CMAKE_CURRENT_SOURCE_DIR}/gchd" GCHD_SRC)
LIST(APPEND SOURCE_LIST ${ROOT_SRC} ${GCHD_SRC})

ADD_EXECUTABLE(${PROJECT_NAME} ${SOURCE_LIST})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} stdc++ pthread -L${LIBUSB_LIBRARY_DIRS} -Wl,-rpath,${LIBUSB_LIBRARY_DIRS} ${LIBUSB_LIBRARIES})

INSTALL(TARGETS ${PROJECT_NAME} DESTINATION bin)
